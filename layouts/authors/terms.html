{{- define "main" -}}

{{ partial "page_header.html" . }}

<div class="universal-wrapper">
    <div class="row">
        <div class="col-12 col-lg-12">
            {{ with .Content }}<div class="article-style">{{ . }}</div>{{ end }}
            {{ $paginator := .Paginate .Data.Pages }}
            {{ range $k, $v := $paginator.Pages }}
                {{ $summary := "" }}
                {{ with $v.Params.bio }}{{ $summary = . | markdownify | emojify }}{{ end }}
                {{ $name := $v.Params.name | default ($v.Title|plainify) }}

                <div class="media stream-item author">
                    {{ $avatar := ($v.Resources.ByType "image").GetMatch "*avatar*" }}
                    {{ $avatar_shape := site.Params.avatar.shape | default "circle" }}

                    {{ if and site.Params.avatar.gravatar $v.Params.email }}
                        <img class="avatar mr-3 {{if eq $avatar_shape "square"}}avatar-square{{else}}avatar-circle{{end}}" src="https://s.gravatar.com/avatar/{{ md5 .Params.email }}?s=200')" alt="Avatar">
                    {{ else if $avatar }}
                        {{ $avatar_image := $avatar.Fill "270x270 Center" }}
                        <img class="avatar mr-3 {{if eq $avatar_shape "square"}}avatar-square{{else}}avatar-circle{{end}}" src="{{ $avatar_image.RelPermalink }}" alt="Avatar">
                    {{ end }}
            
                    <div class="media-body">
                        <h5 class="author card-title mb-00 mt=0"><a href="{{ $v.Permalink }}">{{ $v.Params.name }}</a></h5>
                        {{ with $v.Params.role }}<h6 class="card-subtitle">{{. | markdownify | emojify}}</h6>{{end}}
                        {{ with $v.Params.bio }}<p class="card-text">{{. | markdownify | emojify}}</p>{{end}}
                        {{ partial "social_links" $v }}
                        <p class="all-posts"><a href="">See all posts by author</a></p>
                    </div>
                </div>
            {{end}}
        </div>
        {{ partial "pagination" . }}
    </div>
</div>
{{- end -}}
